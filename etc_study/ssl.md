SSLは、認証・暗号化・改竄（かいざん）検出の機能を提供する。

# SSLの種類

1. サーバ認証
2. クライアント認証

## サーバ認証

サーバー認証は、WEBサイトへアクセスしたクライアントが、正規のWEBサイトにアクセスしているかを確認するための認証。  

1. クライアントは、サーバへアクセス
2. サーバはクライアントへサーバ証明書を返却
3. クライアントはサーバ証明書の内容を見て以下を実施
  - クライアント自身が信頼するCAによる電子署名であるか確認
  - 公開鍵を取得
4. クライアントは上記で取得した公開鍵で共通鍵を暗号化して送信
5. サーバはクライアントから送信された暗号化データを秘密鍵で復号化して共通鍵を取得
  - サーバは公開鍵に対応した秘密鍵を持っている

### サーバ証明書

サーバ証明書には以下が含まれる。

- ウェブサーバの情報（識別名（ディスティングイッシュネーム））
  - Common Name（コモンネーム）
  - Organizational Name（組織名）
  - Organizational Unit（部署名）
  - Locality（市区町村名）
  - State（都道府県名）
  - Country（国コード）
- ウェブサーバの公開鍵
- 証明書発行局名
- 証明書発行局の電子署名
- 有効期間
- 証明書の基本情報
  - 証明書のバージョン（X.509 Ver.3など）
  - 証明書の通し番号
  - 電子署名に使われている暗号化方式

## クライアント認証

クライアント認証は、「サービス」を利用しようとしているクライアント（ユーザーやデバイス）をサーバーが認証する。  
なお、クライアント認証は、サーバ認証することが前提となる。

1. クライアントは、サーバへアクセス
2. サーバはクライアントに、クライアント証明書を要求
3. クライアントは、クライアント証明書をサーバへ送付
  - そのとき、クライアント証明書をユーザが選択する
4. サーバは署名されたクライアント証明書を解読しクライアントの公開鍵を取得
5. クライアントは、送付メッセージにダイジェストを付加し、クライアントの持つ秘密鍵で暗号化する
6. サーバは、クライアントの公開鍵を使ってメッセージを解読
7. 解読したメッセージからメッセージ・ダイジェストを作成し、クライアントが付加したメッセージ・ダイジェストと比較する
8. 一致が確認されれば、信頼できるクライアントから改ざんされていないメッセージを受信したと言える
